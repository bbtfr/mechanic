<h3 class="page-header">点评技师</h3>

<div class="row">
  <div class="col-md-7">
    <%= bootstrap_simple_form_for([ :merchants, @order ], url: review_merchants_hosting_order_path(@order)) do |f| %>
      <%= f.error_messages %>

      <%= f.input :professionality do %>
        <div class="stars">
          <%= bootstrap_icon_stars @order.professionality %>
          <%= f.hidden_field :professionality %>
        </div>
      <% end %>
      <%= f.input :timeliness do %>
        <div class="stars">
          <%= bootstrap_icon_stars @order.timeliness %>
          <%= f.hidden_field :timeliness %>
        </div>
      <% end %>
      <%= f.input :review, input_html: { rows: 4 } %>

      <%= f.button :submit, "确定", class: "btn-primary pull-right" %>
    <% end %>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    var $elements = $(".stars .glyphicon");
    $elements.click(function() {
      var $parent = $(this).parent();
      var $icons = $parent.find(".glyphicon");
      var $hiddenInput = $parent.find("input[type=hidden]");
      var value = $icons.index(this) + 1;

      $hiddenInput.val(value);
      $icons.slice(0, value).removeClass("glyphicon-star-empty").addClass("glyphicon-star");
      $icons.slice(value, $icons.length).removeClass("glyphicon-star").addClass("glyphicon-star-empty");
    });
  });
</script>
